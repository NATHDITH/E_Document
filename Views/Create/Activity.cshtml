@{
    ViewData["Title"] = "Create Document";
}

<h2>สร้างเอกสารโครงการ</h2>

<form asp-action="GenerateActivityPdf" method="post">
    <div class="form-group">
        <label for="ProjectCode">เลือกโครงการ:</label>
        <select id="ProjectCode" name="ProjectCode" class="form-control">
            <option value="">-- กรุณาเลือกรหัสโครงการ --</option>
            @foreach (var item in ViewBag.ProjectCodeList as SelectList)
            {
                <option value="@item.Value">@item.Text</option>
            }
        </select>
    </div>

    <div class="form-group mt-3 border p-3">
        <label>ชื่อโครงการ:</label>
        <input type="text" id="ProjectName" class="form-control mb-2" readonly />

        <label>รหัสโครงการ:</label>
        <input type="text" id="ProjectCodeInput" class="form-control mb-2" readonly />

        <label>เลขออกหนังสืออนุมัติโครงการ:</label>
        <input type="text" id="DocNo" class="form-control mb-2" readonly />

        <label>วันออกหนังสืออนุมัติโครงการ:</label>
        <input type="date" id="CreateDate" class="form-control mb-2" readonly />

        <label>วันเริ่มเตรียมโครงการ:</label>
        <input type="date" id="StartDate" class="form-control mb-2" readonly />

        <label>วันเริ่มโครงการ:</label>
        <input type="date" id="ProjectDate" class="form-control mb-2" readonly />

        <label>วันสิ้นสุดโครงการ:</label>
        <input type="date" id="EndDate" class="form-control mb-2" readonly />

        <label>สถานที่โครงการ:</label>
        <input type="text" id="Location" class="form-control mb-2" readonly />

        <label>จำนวนเงินบำรุงโครงการ:</label>
        <input type="number" id="Maintenancemoney" class="form-control mb-2" readonly />

        <label>จำนวนเงินบำรุงโครงการ (ข้อความ):</label>
        <input type="text" id="Maintenancemoneytext" class="form-control mb-2" readonly />

        <label>จำนวนเงินสะสม:</label>
        <input type="number" id="Accumulatedmoney" class="form-control mb-2" readonly />

        <label>จำนวนเงินสะสม (ข้อความ):</label>
        <input type="text" id="Accumulatedmoneytext" class="form-control mb-2" readonly />

        <label>เงินอื่น ๆ:</label>
        <input type="number" id="Othermoney" class="form-control mb-2" readonly />

        <label>เงินอื่น ๆ (ข้อความ):</label>
        <input type="text" id="Othermoneytext" class="form-control mb-2" readonly />

        <label>กิจกรรมมหาวิทยาลัย (สถานะ):</label>
        <input type="number" id="_1universityactivitiesSt" class="form-control mb-2" readonly />

        <label>กิจกรรมมหาวิทยาลัย:</label>
        <input type="number" id="_1universityactivities" class="form-control mb-2" readonly />

        <label>จิตสาธารณะ (สถานะ):</label>
        <input type="number" id="_211publicspiritactivitiesSt" class="form-control mb-2" readonly />

        <label>จิตสาธารณะ:</label>
        <input type="number" id="_211publicspiritactivities" class="form-control mb-2" readonly />

        <label>คุณธรรมจริยธรรม (สถานะ):</label>
        <input type="number" id="_212moralSt" class="form-control mb-2" readonly />

        <label>คุณธรรมจริยธรรม:</label>
        <input type="number" id="_212moral" class="form-control mb-2" readonly />

        <label>พัฒนาสมรรถนะ (สถานะ):</label>
        <input type="number" id="_221competencybuildingactivitiesSt" class="form-control mb-2" readonly />

        <label>พัฒนาสมรรถนะ:</label>
        <input type="number" id="_221competencybuildingactivities" class="form-control mb-2" readonly />

        <label>ทักษะ IT (สถานะ):</label>
        <input type="number" id="_222itskillsSt" class="form-control mb-2" readonly />

        <label>ทักษะ IT:</label>
        <input type="number" id="_222itskills" class="form-control mb-2" readonly />

        <label>พัฒนาอื่น ๆ (สถานะ):</label>
        <input type="number" id="_223developingSt" class="form-control mb-2" readonly />

        <label>พัฒนาอื่น ๆ:</label>
        <input type="number" id="_223developing" class="form-control mb-2" readonly />

        <label>ประชาธิปไตย (สถานะ):</label>
        <input type="number" id="_231democraticSt" class="form-control mb-2" readonly />

        <label>ประชาธิปไตย:</label>
        <input type="number" id="_231democratic" class="form-control mb-2" readonly />

        <label>ความสัมพันธ์ (สถานะ):</label>
        <input type="number" id="_232relationshipsSt" class="form-control mb-2" readonly />

        <label>ความสัมพันธ์:</label>
        <input type="number" id="_232relationships" class="form-control mb-2" readonly />

        <label>สุขภาพ (สถานะ):</label>
        <input type="number" id="_24healthSt" class="form-control mb-2" readonly />

        <label>สุขภาพ:</label>
        <input type="number" id="_24health" class="form-control mb-2" readonly />

        <label>กิจกรรมเสริมหลักสูตร (สถานะ):</label>
        <input type="number" id="_31activitiesSt" class="form-control mb-2" readonly />

        <label>กิจกรรมเสริมหลักสูตร:</label>
        <input type="number" id="_31activities" class="form-control mb-2" readonly />

        <label>สังคม (สถานะ):</label>
        <input type="number" id="_32socialSt" class="form-control mb-2" readonly />

        <label>สังคม:</label>
        <input type="number" id="_32social" class="form-control mb-2" readonly />




        <input type="hidden" id="ProjectNameInput" name="ProjectName" />
        <input type="hidden" id="ProjectCodeInput" name="ProjectCode" />
        <input type="hidden" id="DocNoInput" name="DocNo" />
        <input type="hidden" id="CreateDateInput" name="CreateDate" />
        <input type="hidden" id="StartDateInput" name="StartDate" />
        <input type="hidden" id="ProjectDateInput" name="Projectdate" />
        <input type="hidden" id="EndDateInput" name="EndDate" />
        <input type="hidden" id="LocationInput" name="Location" />
        <input type="hidden" id="MaintenancemoneyInput" name="Maintenancemoney" />
        <input type="hidden" id="MaintenancemoneytextInput" name="Maintenancemoneytext" />
        <input type="hidden" id="AccumulatedmoneyInput" name="Accumulatedmoney" />
        <input type="hidden" id="AccumulatedmoneytextInput" name="Accumulatedmoneytext" />
        <input type="hidden" id="OthermoneyInput" name="Othermoney" />
        <input type="hidden" id="OthermoneytextInput" name="Othermoneytext" />
        <input type="hidden" id="_1universityactivitiesStInput" name="_1universityactivitiesSt" />
        <input type="hidden" id="_1universityactivitiesInput" name="_1universityactivities" />
        <input type="hidden" id="_211publicspiritactivitiesStInput" name="_211publicspiritactivitiesSt" />
        <input type="hidden" id="_211publicspiritactivitiesInput" name="_211publicspiritactivities" />
        <input type="hidden" id="_212moralStInput" name="_212moralSt" />
        <input type="hidden" id="_212moralInput" name="_212moral" />
        <input type="hidden" id="_221competencybuildingactivitiesStInput" name="_221competencybuildingactivitiesSt" />
        <input type="hidden" id="_221competencybuildingactivitiesInput" name="_221competencybuildingactivities" />
        <input type="hidden" id="_222itskillsStInput" name="_222itskillsSt" />
        <input type="hidden" id="_222itskillsInput" name="_222itskills" />
        <input type="hidden" id="_223developingStInput" name="_223developingSt" />
        <input type="hidden" id="_223developingInput" name="_223developing" />
        <input type="hidden" id="_231democraticStInput" name="_231democraticSt" />
        <input type="hidden" id="_231democraticInput" name="_231democratic" />
        <input type="hidden" id="_232relationshipsStInput" name="_232relationshipsSt" />
        <input type="hidden" id="_232relationshipsInput" name="_232relationships" />
        <input type="hidden" id="_24healthStInput" name="_24healthSt" />
        <input type="hidden" id="_24healthInput" name="_24health" />
        <input type="hidden" id="_31activitiesStInput" name="_31activitiesSt" />
        <input type="hidden" id="_31activitiesInput" name="_31activities" />
        <input type="hidden" id="_32socialStInput" name="_32socialSt" />
        <input type="hidden" id="_32socialInput" name="_32social" />



    </div>
    <div class="mb-3">
        <label class="form-label">เลขหนังสือเบิกค่าใช้จ่ายโครงการ:</label>
        <input type="text" name="DocNoDis" class="form-control" required />
    </div>
    <div class="mb-3">
        <label class="form-label">วันที่ออกหนังสือเบิกค่าใช้จ่ายโครงการ:</label>
        <input type="date" name="CreateDateDis" class="form-control" required id="CreateDateDis" />
    </div>
    <button type="submit" class="btn btn-primary mt-3">Submit</button>
</form>



@section Scripts {
    <script>
        var projectDetails = @Html.Raw(ViewBag.ProjectDetailsJson);

        document.getElementById('ProjectCode').addEventListener('change', function () {
            var selectedCode = this.value;
            var selected = projectDetails.find(p => p.ProjectCode === selectedCode);

            if (selected) {
                // กรอกข้อมูลในฟอร์มที่มีอยู่CreateDate
                document.getElementById('ProjectName').value = selected.ProjectName || '';
                document.getElementById('DocNo').value = selected.DocNo || '';
                document.getElementById('ProjectCodeInput').value = selected.ProjectCode || '';
                document.getElementById('StartDate').value = selected.StartDate?.split('T')[0] || '';
                document.getElementById('CreateDate').value = selected.CreateDate?.split('T')[0] || '';
                document.getElementById('ProjectDate').value = selected.Projectdate?.split('T')[0] || '';
                document.getElementById('EndDate').value = selected.EndDate?.split('T')[0] || '';
                document.getElementById('Location').value = selected.Location || '';
                document.getElementById('Maintenancemoney').value = selected.Maintenancemoney || '';
                document.getElementById('Accumulatedmoney').value = selected.Accumulatedmoney || '';
                document.getElementById('Othermoney').value = selected.Othermoney || '';
                document.getElementById('Maintenancemoneytext').value = selected.Maintenancemoneytext || '';
                document.getElementById('Accumulatedmoneytext').value = selected.Accumulatedmoneytext || '';
                document.getElementById('Othermoneytext').value = selected.Othermoneytext || '';
                document.getElementById('_1universityactivitiesSt').value = selected._1universityactivitiesSt || '';
                document.getElementById('_1universityactivities').value = selected._1universityactivities || '';
                document.getElementById('_211publicspiritactivitiesSt').value = selected._211publicspiritactivitiesSt || '';
                document.getElementById('_211publicspiritactivities').value = selected._211publicspiritactivities || '';
                document.getElementById('_212moralSt').value = selected._212moralSt || '';
                document.getElementById('_212moral').value = selected._212moral || '';
                document.getElementById('_221competencybuildingactivitiesSt').value = selected._221competencybuildingactivitiesSt || '';
                document.getElementById('_221competencybuildingactivities').value = selected._221competencybuildingactivities || '';
                document.getElementById('_222itskillsSt').value = selected._222itskillsSt || '';
                document.getElementById('_222itskills').value = selected._222itskills || '';
                document.getElementById('_223developingSt').value = selected._223developingSt || '';
                document.getElementById('_223developing').value = selected._223developing || '';
                document.getElementById('_231democraticSt').value = selected._231democraticSt || '';
                document.getElementById('_231democratic').value = selected._231democratic || '';
                document.getElementById('_232relationshipsSt').value = selected._232relationshipsSt || '';
                document.getElementById('_232relationships').value = selected._232relationships || '';
                document.getElementById('_24healthSt').value = selected._24healthSt || '';
                document.getElementById('_24health').value = selected._24health || '';
                document.getElementById('_31activitiesSt').value = selected._31activitiesSt || '';
                document.getElementById('_31activities').value = selected._31activities || '';
                document.getElementById('_32socialSt').value = selected._32socialSt || '';
                document.getElementById('_32social').value = selected._32social || '';

                // กรอกข้อมูลที่เป็น hidden
                document.getElementById('ProjectNameInput').value = selected.ProjectName || '';
                document.getElementById('DocNoInput').value = selected.DocNo || '';
                document.getElementById('StartDateInput').value = selected.StartDate?.split('T')[0] || '';
                document.getElementById('CreateDateInput').value = selected.CreateDate?.split('T')[0] || '';
                document.getElementById('ProjectDateInput').value = selected.Projectdate?.split('T')[0] || '';
                document.getElementById('EndDateInput').value = selected.EndDate?.split('T')[0] || '';
                document.getElementById('LocationInput').value = selected.Location || '';
                document.getElementById('MaintenancemoneyInput').value = selected.Maintenancemoney || '';
                document.getElementById('AccumulatedmoneyInput').value = selected.Accumulatedmoney || '';
                document.getElementById('OthermoneyInput').value = selected.Othermoney || '';
                document.getElementById('MaintenancemoneytextInput').value = selected.Maintenancemoneytext || '';
                document.getElementById('AccumulatedmoneytextInput').value = selected.Accumulatedmoneytext || '';
                document.getElementById('OthermoneytextInput').value = selected.Othermoneytext || '';

                // กรอกข้อมูลกิจกรรมต่างๆ
                document.getElementById('_1universityactivitiesStInput').value = selected._1universityactivitiesSt || '';
                document.getElementById('_1universityactivitiesInput').value = selected._1universityactivities || '';
                document.getElementById('_211publicspiritactivitiesStInput').value = selected._211publicspiritactivitiesSt || '';
                document.getElementById('_211publicspiritactivitiesInput').value = selected._211publicspiritactivities || '';
                document.getElementById('_212moralStInput').value = selected._212moralSt || '';
                document.getElementById('_212moralInput').value = selected._212moral || '';
                document.getElementById('_221competencybuildingactivitiesStInput').value = selected._221competencybuildingactivitiesSt || '';
                document.getElementById('_221competencybuildingactivitiesInput').value = selected._221competencybuildingactivities || '';
                document.getElementById('_222itskillsStInput').value = selected._222itskillsSt || '';
                document.getElementById('_222itskillsInput').value = selected._222itskills || '';
                document.getElementById('_223developingStInput').value = selected._223developingSt || '';
                document.getElementById('_223developingInput').value = selected._223developing || '';
                document.getElementById('_231democraticStInput').value = selected._231democraticSt || '';
                document.getElementById('_231democraticInput').value = selected._231democratic || '';
                document.getElementById('_232relationshipsStInput').value = selected._232relationshipsSt || '';
                document.getElementById('_232relationshipsInput').value = selected._232relationships || '';
                document.getElementById('_24healthStInput').value = selected._24healthSt || '';
                document.getElementById('_24healthInput').value = selected._24health || '';
                document.getElementById('_31activitiesStInput').value = selected._31activitiesSt || '';
                document.getElementById('_31activitiesInput').value = selected._31activities || '';
                document.getElementById('_32socialStInput').value = selected._32socialSt || '';
                document.getElementById('_32socialInput').value = selected._32social || '';
            } else {
                // เคลียร์ข้อมูลหากไม่พบ
                document.getElementById('ProjectName').value = '';
                document.getElementById('DocNo').value = '';
                document.getElementById('ProjectCodeInput').value = '';
                document.getElementById('StartDate').value = '';
                document.getElementById('ProjectDate').value = '';
                document.getElementById('EndDate').value = '';
                document.getElementById('Location').value = '';
                document.getElementById('Maintenancemoney').value = '';
                document.getElementById('Accumulatedmoney').value = '';
                document.getElementById('Othermoney').value = '';
                document.getElementById('Maintenancemoneytext').value = '';
                document.getElementById('Accumulatedmoneytext').value = '';
                document.getElementById('Othermoneytext').value = '';

                // เคลียร์ข้อมูลกิจกรรมต่างๆ
                document.getElementById('_1universityactivitiesSt').value = '';
                document.getElementById('_1universityactivities').value = '';
                document.getElementById('_211publicspiritactivitiesSt').value = '';
                document.getElementById('_211publicspiritactivities').value = '';
                document.getElementById('_212moralSt').value = '';
                document.getElementById('_212moral').value = '';
                document.getElementById('_221competencybuildingactivitiesSt').value = '';
                document.getElementById('_221competencybuildingactivities').value = '';
                document.getElementById('_222itskillsSt').value = '';
                document.getElementById('_222itskills').value = '';
                document.getElementById('_223developingSt').value = '';
                document.getElementById('_223developing').value = '';
                document.getElementById('_231democraticSt').value = '';
                document.getElementById('_231democratic').value = '';
                document.getElementById('_232relationshipsSt').value = '';
                document.getElementById('_232relationships').value = '';
                document.getElementById('_24healthSt').value = '';
                document.getElementById('_24health').value = '';
                document.getElementById('_31activitiesSt').value = '';
                document.getElementById('_31activities').value = '';
                document.getElementById('_32socialSt').value = '';
                document.getElementById('_32social').value = '';
            }
        });

        document.addEventListener("DOMContentLoaded", function () {
            const createDateDisInput = document.getElementById("CreateDateDis");
            const today = new Date().toISOString().split("T")[0];
            createDateDisInput.setAttribute("min", today);
        });
    </script>
}